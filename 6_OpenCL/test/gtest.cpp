#include <vector>
#include <gtest/gtest.h>

#include "bsort.h"

namespace GTests {

struct bitonic_sort : ::testing::Test {
    OpenCL::IOpenCL_app app{};
};

TEST_F(bitonic_sort, test3) {
    std::vector<float> sequence {5.f, 3.f, 1.f};
    std::vector<float> correct  {1.f, 3.f, 5.f};

    auto res = app.bitonic_sort(sequence);
    EXPECT_EQ(1, std::get<0>(res) == correct);
}

TEST_F(bitonic_sort, test6) {
    std::vector<float> sequence {3.f, 5.f, 4.f, 1.f, 2.f, 6.f};
    std::vector<float> correct  {1.f, 2.f, 3.f, 4.f, 5.f, 6.f};

    auto res = app.bitonic_sort(sequence);
    EXPECT_EQ(1, std::get<0>(res) == correct);
}

TEST_F(bitonic_sort, test32) {
    std::vector<float> sequence {664.311, 618.196, -833.805, 522.744, 673.402, 998.018, -380.45, 675.781, 469.587, 261.689, -195.714, -987.415, 346.982, 390.831, 565.423, 557.58, -909.149, -869.018, 311.662, 341.043, -913.056, -313.805, -634.683, 874.578, -387.027, -152.506, -802.989, -788.433, 829.813, -823.499, -542.377, 749.585};
    std::vector<float> correct  {-987.415, -913.056, -909.149, -869.018, -833.805, -823.499, -802.989, -788.433, -634.683, -542.377, -387.027, -380.45, -313.805, -195.714, -152.506, 261.689, 311.662, 341.043, 346.982, 390.831, 469.587, 522.744, 557.58, 565.423, 618.196, 664.311, 673.402, 675.781, 749.585, 829.813, 874.578, 998.018};

    auto res = app.bitonic_sort(sequence);
    EXPECT_EQ(1, std::get<0>(res) == correct);
}

TEST_F(bitonic_sort, test64) {
    std::vector<float> sequence {-205.312, -446.874, 668.151, 224.369, 335.916, 732.115, 993.383, -103.326, -410.843, -60.4781, -174.688, 162.026, 362.071, -682.397, 944.08, 286.279, 711.33, -813.898, 549.984, 129.301, 785.699, -902.723, 528.926, 554.156, 721.607, 359.952, -189.085, 956.156, -121.447, 679.843, -65.074, -137.243, -600.907, 86.4978, 733.596, -598.387, 155.462, 907.929, 17.2419, -973.024, -536.534, 171.033, -739.903, -134.797, -605.928, 883.188, 593.335, 264.864, -450.43, 713.097, 231.02, -955.378, -237.361, -286.716, 134.798, -573.354, -249.74, 779.743, 137.815, -976.079, 823.941, 467.053, -295.986, -727.813};
    std::vector<float> correct  {-976.079, -973.024, -955.378, -902.723, -813.898, -739.903, -727.813, -682.397, -605.928, -600.907, -598.387, -573.354, -536.534, -450.43, -446.874, -410.843, -295.986, -286.716, -249.74, -237.361, -205.312, -189.085, -174.688, -137.243, -134.797, -121.447, -103.326, -65.074, -60.4781, 17.2419, 86.4978, 129.301, 134.798, 137.815, 155.462, 162.026, 171.033, 224.369, 231.02, 264.864, 286.279, 335.916, 359.952, 362.071, 467.053, 528.926, 549.984, 554.156, 593.335, 668.151, 679.843, 711.33, 713.097, 721.607, 732.115, 733.596, 779.743, 785.699, 823.941, 883.188, 907.929, 944.08, 956.156, 993.383};

    auto res = app.bitonic_sort(sequence);
    EXPECT_EQ(1, std::get<0>(res) == correct);
}

TEST_F(bitonic_sort, test1024) {
    std::vector<float> sequence {-539.778, 690.139, 733.559, 875.41, -56.7617, -541.557, -882.029, -374.902, 788.749, -10.9008, 565.992, -356.386, -487.203, 45.4343, 630.655, 509.283, -854.162, -96.6014, -868.155, 662.313, 691.451, 446.522, 203.609, -139.044, -938.698, 608.184, -8.81415, -4.85071, -498.722, 543.946, -696.879, -152.851, 306.245, 293.924, 909.191, 545.453, 162.943, 605.032, 346.548, -75.5706, -127.657, 706.171, -529.112, -142.129, 116.73, 581.687, 317.766, 393.529, 568.859, 902.626, -291.866, -801.498, 165.798, 85.4099, -711.37, -816.547, -267.308, -45.9396, -659.754, 498.087, 479.166, 247.514, -107.606, 878.69, 347.503, 729.262, -362.964, -235.957, 280.541, 985.131, 203.534, 697.04, -452.707, 123.551, 683.96, -672.427, -704.303, 953.2, 286.118, -776.043, 938.887, 294.035, 474.59, 720.277, -678.495, -650.67, -888.706, 629.328, -756.517, -202.759, -947.481, 402.508, -442.173, -460.936, 450.33, 844.461, 823.246, -67.3829, -444.634, 477.933, 581.719, -412.931, 767.891, -97.6938, 45.8947, -689.217, -488.544, 814.49, 881.782, -139.658, 942.372, -909.144, -359.067, -230.434, 272.077, -981.619, 150.976, 440.678, -724.216, -728.116, -1.42035, 654.447, -633.38, 840.42, -573.214, -574.404, -802.4, -794.921, -698.401, -404.629, -47.3572, 195.538, -356.139, 135.572, 396.249, -865.781, -865.141, -287.998, -671.355, 609.405, -349.699, 362.317, -624.264, 280.027, -381.136, 733.194, 846.803, -318.349, 975.704, -160.799, 205.806, 134.572, -955.693, -45.1843, 58.3878, 821.413, -661.938, 597.848, -614.484, 86.8713, 473.57, 58.0482, 823.317, -195.716, 476.612, -451.726, 317.785, -931.771, -679.306, 745.396, -887.59, -11.3502, -817.824, 446.147, -14.3192, 491.071, 546.724, -5.48083, -663.263, 916.463, -653.199, 833.985, 151.706, -186.034, 414.709, -226.194, 684.202, -556.082, 364.345, 436.535, 179.965, 947.528, 213.176, 758.913, 704.762, 268.059, 276.955, -353.328, -557.657, -757.471, -14.5505, -784.309, 628.492, 394.22, -392.132, -160.403, 255.615, -603.245, -609.528, -880.361, -456.052, 447.673, 507.997, 801.092, 9.60876, 292.338, 222.441, -992.943, -491.157, 738.938, 479.998, 595.153, 318.914, -815.044, -919.494, -234.608, 743.038, 946.9, -188.263, -395.316, -752.701, -169.081, -256.802, 439.647, 502.332, -864.319, -50.8931, -927.498, -299.774, 693.648, -62.688, 182.86, -320.43, -49.3441, -266.444, 36.9867, 791.139, 616.956, -113.13, -55.33, -959.214, -83.2874, -688.653, 644.069, 586.025, 798.256, -839.297, -316.058, -38.4051, -498.328, -599.053, 321.854, -86.8372, -414.578, -378.667, 480.179, -839.651, 24.7538, 232.492, -90.6422, -584.531, -679.006, 211.484, -549.849, -903.682, -210.089, -60.1849, 691.975, 398.607, -552.689, 436.296, 104.403, -609.581, -436.178, 9.31671, 429.14, -745.727, 930.608, -163.787, -787.272, -830.095, 529.652, 13.8683, -653.803, -973.04, -903.878, -77.5227, 202.01, -853.568, 909.524, -305.858, 729.382, -61.834, -142.516, -436.806, 990.302, 479.488, 574.981, 84.6293, 380.199, -159.035, -369.865, -826.467, 195.326, -614, -648.98, -678.429, -379.981, -671.47, -834.515, -893.498, -226.271, -912.684, 126.433, 122.529, 895.848, 171.739, -116.678, 19.8658, 287.42, 571.518, 774.906, -771.714, -428.156, 143.964, 842.239, 304.92, 904.94, 772.298, 952.024, 485.88, 139.222, 286.766, 749.216, -548.477, 965.393, 195.283, 381.477, 794.334, 363.202, -45.4153, -149.748, -661.616, 212.359, -377.682, -974.284, 887.693, -432.548, 886.502, 606.728, 778.047, -240.237, -426.19, -857.616, 290.717, -781.896, 579.026, -957.255, 902.932, 343.441, -864.964, 156.276, 724.251, 680.324, 628.68, 125.071, 897.528, -827.555, 587.957, -164.764, 929.929, -106.353, -762.67, -138.781, 498.025, -591.907, -450.472, -130.246, 238.859, -223.353, -751.251, 563.361, -835.06, 329.911, 107.995, -625.765, -807.434, 914.341, -573.381, 505.712, 559.67, 3.77527, 228.463, 889.463, 897.154, 386.641, 230.195, 680.222, 820.732, -196.934, -547.016, 833.933, -783.155, -308.216, -204.241, 300.93, 444.703, -127.559, -381.99, -515.076, -63.0323, -904.737, 927.638, 832.113, -202.272, 668.343, 151.068, 143.894, -210.11, 519.771, -505.169, -964.811, -482.905, 211.883, 854.927, 729.531, 938.222, -115.255, -395.027, 252.94, 464.771, 387.527, -846.631, -386.954, 360.81, -140.726, -413.706, 510.329, -278.921, 221.158, -279.06, 763.445, 17.1641, 256.554, -737.394, -834.266, -274.467, 107.996, 973.588, 433.437, 66.197, 408.639, -921.689, -804.234, 465.653, -342.396, 611.955, 31.6193, 672.264, -414.122, 78.4766, 724.752, -111.715, 430.813, 783.426, 839.745, 987.415, 324.292, 597.662, 546.145, 137.768, 127.121, 961.443, 411.611, 172.984, 908.49, -186.963, -887.306, 448.942, -557.594, 551.036, -55.7696, -484.988, -805.44, -286.757, 534.279, -328.945, 276.455, 357.132, 335.076, -865.703, -541.829, 447.296, -877.532, -872.911, 66.0211, -266.931, 196.904, -756.776, 250.518, 54.1796, 915.269, 862.581, 308.091, 229.69, -920.51, -203.518, -291.043, 807.491, 572.602, 6.83368, -622.743, -86.5398, -527.595, 589.975, -635.29, -322.788, -364.277, -701.828, 191.188, 266.762, 237.225, -781.512, -962.413, 568.282, -264.23, -834.251, 942.074, -659.531, -504.264, 741.623, 274.925, 869.843, 66.5122, -276.03, -544.715, 539.874, 816.354, 316.255, 789.749, -78.3986, -797.227, 60.4791, -227.212, -1.02625, 821.915, -61.7409, -43.1965, -762.375, -299.443, 896.608, -221.01, 836.887, 956.901, 857.302, 138.939, -767.071, -442.26, -749.051, 236.662, -151.593, -326.459, 652.438, -328.953, 815.555, 530.578, -481.108, 107.199, -393.604, 537.522, 615.849, -651.496, -533.568, -774.825, 801.228, -545.299, -867.692, -960.045, -738.057, -13.3496, -492.559, 508.181, 573.453, 132.134, 392.375, -658.384, 899.355, -29.2119, 577.043, 628.167, -400.184, 836.3, -74.055, -643.982, -550.679, -824.782, 867.911, -26.5358, 250.568, 39.7263, 662.22, -955.739, 985.069, -24.6235, 682.76, -209.493, -512.248, -507.651, 416.41, -616.69, 129.282, 830.522, -819.615, -730.251, -757.552, 2.25232, 729.962, -159.624, -818.142, 838.115, -561.643, 676.73, -694.952, -194.713, -428.462, 876.96, 225.203, -800.751, -320.209, 855.536, -95.5192, -5.9845, -160.74, -3.14954, 98.6843, 655.978, -335.676, 952.373, 657.809, 371.141, -119.972, -857.452, -887.201, -768.47, 331.458, 311.101, -426.15, -881.177, 371.4, -502.29, 535.839, 457.425, -71.2072, 249.419, 166.725, -500.224, -523.746, -584.388, -892.055, -993.443, -732.998, -35.0092, 937.439, 415.543, -976.952, -269.877, 231.462, -698.128, -867.756, -347.842, 296.184, -54.0887, 180.202, 945.974, -192.613, -281.042, 194.889, -881.35, 130.351, 711.619, -995.987, -967.877, 226.757, 352.887, 904.616, 466.822, -826.83, 808.765, 759.799, 715.455, 534.189, 891.268, -322.638, 450.134, -509.577, 567.633, 630.461, -95.3765, -399.869, -347.089, -401.719, -173.717, 196.14, 970.394, 779.116, -45.1666, 294.441, -9.5907, -305.281, 357.129, -84.8958, -506.997, 216.769, -374.359, -655.288, -815.118, 684.775, -994.36, 149.213, -194.486, 877.874, 663.917, -703.595, -626.878, 842.769, -626.925, -604.443, 944.71, 770.828, -71.0132, 162.826, -674.519, -740.222, -109.915, -306.38, 915.174, -934.166, 518.469, -723.994, 97.1633, 28.5997, -272.674, -701.122, 883.448, -390.358, -733.444, -738, -2.1405, 334.8, -379.05, 45.2489, -655.272, 520.878, -853.677, -334.226, 738.151, -603.631, 437.642, 509.054, -987.681, -547.278, -343.185, -52.8921, 566.847, -904.467, 132.327, -523.046, -361.925, 806.318, 821.759, -534.562, -480.702, 39.4794, -787.19, -290.698, 811.884, 602.808, -588.364, -623.573, -599.465, 41.9523, -25.8801, 945.007, -506.671, -929.723, 168.721, 625.134, -23.7426, 946.071, -460.133, 668.523, 475.267, -726.128, -428.087, -372.608, 439.885, -543.395, -763.652, 953.327, 71.5168, -893.883, -955.076, 99.8488, -125.944, -701.239, 627.459, 932.566, 758.899, 336.765, -484.929, -384.882, -289.477, 942.007, -154.345, -867.284, -64.7838, -698.947, -896.44, 749.834, 858.555, -779.732, 824.927, 266.092, 967.986, 935.164, 165.396, 255.761, -589.093, -880.358, -279.219, 388.005, 115.602, 168.063, 550.36, -94.4734, -46.0726, 63.7755, -114.983, -931.592, 611.097, 612.74, -223.724, -835.215, -248.39, 322.294, -413.713, 771.861, -203.308, 599.006, 197.644, -527.423, -414.491, -406.614, 524.317, 23.9477, 6.17981, -103.273, -61.5615, 669.201, -715.296, -72.3965, 154.756, -569.782, -307.201, 585.912, 272.214, -124.749, -483.242, 36.5377, -552.041, 651.843, 867.343, 781.562, -921.424, 811.316, -489.457, -695.277, 802.788, 440.928, 921.058, 580.071, -955.856, 167.962, 516.544, -679.887, 344.168, -159.278, -541.243, -903.301, 568.926, -205.273, 438.007, -335.128, -251.116, 716.513, 678.78, 859.951, 16.4676, -789.555, 932.667, -486.534, -329.624, -439.905, 949.077, 160.945, 304.632, 722.03, 246.925, 648.874, 915.194, -269.405, 850.951, -36.4926, 762.209, -131.47, -773.257, 294.926, -254.091, -5.52539, -666.493, -801.771, 115.018, 19.1393, 745.513, 292.278, 641.422, -821.465, -795.186, 558.588, -328.872, 952.178, -763.753, 282.919, 148.643, 671.914, 517.734, -98.749, 431.201, 364.148, 418.692, -520.329, -572.756, -440.745, 778.945, 918.283, -428.652, 693.958, 284.012, 74.1825, -32.4, -876.67, -469.448, 70.4269, -394.962, 963.826, 145.434, -17.2001, -82.3917, 28.2695, -886.748, 285.958, 527.866, -453.365, 679.491, 793.915, -267.203, 691.408, -423.682, 461.917, -554.655, 693.142, 412.585, 968.27, 257.289, 8.04388, -718.913, 342.904, -21.7443, -562.303, 718.875, 444.432, 513.589, -484.041, 520.923, -48.9728, 498.327, 802.655, -360.391, -102.419, 296.285, -904.779, -748.491, 38.4481, 410.918, -252.409, 96.8145, -996.783, -930.038, 236.584, 203.834, -932.52, 526.735, -84.5007, -201.513, 527.932, -386.862, 904.783, -824.498, -147.488, -458.753, -584.747, 151.168, -827.562, -650.932};
    std::vector<float> correct  {-996.783, -995.987, -994.36, -993.443, -992.943, -987.681, -981.619, -976.952, -974.284, -973.04, -967.877, -964.811, -962.413, -960.045, -959.214, -957.255, -955.856, -955.739, -955.693, -955.076, -947.481, -938.698, -934.166, -932.52, -931.771, -931.592, -930.038, -929.723, -927.498, -921.689, -921.424, -920.51, -919.494, -912.684, -909.144, -904.779, -904.737, -904.467, -903.878, -903.682, -903.301, -896.44, -893.883, -893.498, -892.055, -888.706, -887.59, -887.306, -887.201, -886.748, -882.029, -881.35, -881.177, -880.361, -880.358, -877.532, -876.67, -872.911, -868.155, -867.756, -867.692, -867.284, -865.781, -865.703, -865.141, -864.964, -864.319, -857.616, -857.452, -854.162, -853.677, -853.568, -846.631, -839.651, -839.297, -835.215, -835.06, -834.515, -834.266, -834.251, -830.095, -827.562, -827.555, -826.83, -826.467, -824.782, -824.498, -821.465, -819.615, -818.142, -817.824, -816.547, -815.118, -815.044, -807.434, -805.44, -804.234, -802.4, -801.771, -801.498, -800.751, -797.227, -795.186, -794.921, -789.555, -787.272, -787.19, -784.309, -783.155, -781.896, -781.512, -779.732, -776.043, -774.825, -773.257, -771.714, -768.47, -767.071, -763.753, -763.652, -762.67, -762.375, -757.552, -757.471, -756.776, -756.517, -752.701, -751.251, -749.051, -748.491, -745.727, -740.222, -738.057, -738, -737.394, -733.444, -732.998, -730.251, -728.116, -726.128, -724.216, -723.994, -718.913, -715.296, -711.37, -704.303, -703.595, -701.828, -701.239, -701.122, -698.947, -698.401, -698.128, -696.879, -695.277, -694.952, -689.217, -688.653, -679.887, -679.306, -679.006, -678.495, -678.429, -674.519, -672.427, -671.47, -671.355, -666.493, -663.263, -661.938, -661.616, -659.754, -659.531, -658.384, -655.288, -655.272, -653.803, -653.199, -651.496, -650.932, -650.67, -648.98, -643.982, -635.29, -633.38, -626.925, -626.878, -625.765, -624.264, -623.573, -622.743, -616.69, -614.484, -614, -609.581, -609.528, -604.443, -603.631, -603.245, -599.465, -599.053, -591.907, -589.093, -588.364, -584.747, -584.531, -584.388, -574.404, -573.381, -573.214, -572.756, -569.782, -562.303, -561.643, -557.657, -557.594, -556.082, -554.655, -552.689, -552.041, -550.679, -549.849, -548.477, -547.278, -547.016, -545.299, -544.715, -543.395, -541.829, -541.557, -541.243, -539.778, -534.562, -533.568, -529.112, -527.595, -527.423, -523.746, -523.046, -520.329, -515.076, -512.248, -509.577, -507.651, -506.997, -506.671, -505.169, -504.264, -502.29, -500.224, -498.722, -498.328, -492.559, -491.157, -489.457, -488.544, -487.203, -486.534, -484.988, -484.929, -484.041, -483.242, -482.905, -481.108, -480.702, -469.448, -460.936, -460.133, -458.753, -456.052, -453.365, -452.707, -451.726, -450.472, -444.634, -442.26, -442.173, -440.745, -439.905, -436.806, -436.178, -432.548, -428.652, -428.462, -428.156, -428.087, -426.19, -426.15, -423.682, -414.578, -414.491, -414.122, -413.713, -413.706, -412.931, -406.614, -404.629, -401.719, -400.184, -399.869, -395.316, -395.027, -394.962, -393.604, -392.132, -390.358, -386.954, -386.862, -384.882, -381.99, -381.136, -379.981, -379.05, -378.667, -377.682, -374.902, -374.359, -372.608, -369.865, -364.277, -362.964, -361.925, -360.391, -359.067, -356.386, -356.139, -353.328, -349.699, -347.842, -347.089, -343.185, -342.396, -335.676, -335.128, -334.226, -329.624, -328.953, -328.945, -328.872, -326.459, -322.788, -322.638, -320.43, -320.209, -318.349, -316.058, -308.216, -307.201, -306.38, -305.858, -305.281, -299.774, -299.443, -291.866, -291.043, -290.698, -289.477, -287.998, -286.757, -281.042, -279.219, -279.06, -278.921, -276.03, -274.467, -272.674, -269.877, -269.405, -267.308, -267.203, -266.931, -266.444, -264.23, -256.802, -254.091, -252.409, -251.116, -248.39, -240.237, -235.957, -234.608, -230.434, -227.212, -226.271, -226.194, -223.724, -223.353, -221.01, -210.11, -210.089, -209.493, -205.273, -204.241, -203.518, -203.308, -202.759, -202.272, -201.513, -196.934, -195.716, -194.713, -194.486, -192.613, -188.263, -186.963, -186.034, -173.717, -169.081, -164.764, -163.787, -160.799, -160.74, -160.403, -159.624, -159.278, -159.035, -154.345, -152.851, -151.593, -149.748, -147.488, -142.516, -142.129, -140.726, -139.658, -139.044, -138.781, -131.47, -130.246, -127.657, -127.559, -125.944, -124.749, -119.972, -116.678, -115.255, -114.983, -113.13, -111.715, -109.915, -107.606, -106.353, -103.273, -102.419, -98.749, -97.6938, -96.6014, -95.5192, -95.3765, -94.4734, -90.6422, -86.8372, -86.5398, -84.8958, -84.5007, -83.2874, -82.3917, -78.3986, -77.5227, -75.5706, -74.055, -72.3965, -71.2072, -71.0132, -67.3829, -64.7838, -63.0323, -62.688, -61.834, -61.7409, -61.5615, -60.1849, -56.7617, -55.7696, -55.33, -54.0887, -52.8921, -50.8931, -49.3441, -48.9728, -47.3572, -46.0726, -45.9396, -45.4153, -45.1843, -45.1666, -43.1965, -38.4051, -36.4926, -35.0092, -32.4, -29.2119, -26.5358, -25.8801, -24.6235, -23.7426, -21.7443, -17.2001, -14.5505, -14.3192, -13.3496, -11.3502, -10.9008, -9.5907, -8.81415, -5.9845, -5.52539, -5.48083, -4.85071, -3.14954, -2.1405, -1.42035, -1.02625, 2.25232, 3.77527, 6.17981, 6.83368, 8.04388, 9.31671, 9.60876, 13.8683, 16.4676, 17.1641, 19.1393, 19.8658, 23.9477, 24.7538, 28.2695, 28.5997, 31.6193, 36.5377, 36.9867, 38.4481, 39.4794, 39.7263, 41.9523, 45.2489, 45.4343, 45.8947, 54.1796, 58.0482, 58.3878, 60.4791, 63.7755, 66.0211, 66.197, 66.5122, 70.4269, 71.5168, 74.1825, 78.4766, 84.6293, 85.4099, 86.8713, 96.8145, 97.1633, 98.6843, 99.8488, 104.403, 107.199, 107.995, 107.996, 115.018, 115.602, 116.73, 122.529, 123.551, 125.071, 126.433, 127.121, 129.282, 130.351, 132.134, 132.327, 134.572, 135.572, 137.768, 138.939, 139.222, 143.894, 143.964, 145.434, 148.643, 149.213, 150.976, 151.068, 151.168, 151.706, 154.756, 156.276, 160.945, 162.826, 162.943, 165.396, 165.798, 166.725, 167.962, 168.063, 168.721, 171.739, 172.984, 179.965, 180.202, 182.86, 191.188, 194.889, 195.283, 195.326, 195.538, 196.14, 196.904, 197.644, 202.01, 203.534, 203.609, 203.834, 205.806, 211.484, 211.883, 212.359, 213.176, 216.769, 221.158, 222.441, 225.203, 226.757, 228.463, 229.69, 230.195, 231.462, 232.492, 236.584, 236.662, 237.225, 238.859, 246.925, 247.514, 249.419, 250.518, 250.568, 252.94, 255.615, 255.761, 256.554, 257.289, 266.092, 266.762, 268.059, 272.077, 272.214, 274.925, 276.455, 276.955, 280.027, 280.541, 282.919, 284.012, 285.958, 286.118, 286.766, 287.42, 290.717, 292.278, 292.338, 293.924, 294.035, 294.441, 294.926, 296.184, 296.285, 300.93, 304.632, 304.92, 306.245, 308.091, 311.101, 316.255, 317.766, 317.785, 318.914, 321.854, 322.294, 324.292, 329.911, 331.458, 334.8, 335.076, 336.765, 342.904, 343.441, 344.168, 346.548, 347.503, 352.887, 357.129, 357.132, 360.81, 362.317, 363.202, 364.148, 364.345, 371.141, 371.4, 380.199, 381.477, 386.641, 387.527, 388.005, 392.375, 393.529, 394.22, 396.249, 398.607, 402.508, 408.639, 410.918, 411.611, 412.585, 414.709, 415.543, 416.41, 418.692, 429.14, 430.813, 431.201, 433.437, 436.296, 436.535, 437.642, 438.007, 439.647, 439.885, 440.678, 440.928, 444.432, 444.703, 446.147, 446.522, 447.296, 447.673, 448.942, 450.134, 450.33, 457.425, 461.917, 464.771, 465.653, 466.822, 473.57, 474.59, 475.267, 476.612, 477.933, 479.166, 479.488, 479.998, 480.179, 485.88, 491.071, 498.025, 498.087, 498.327, 502.332, 505.712, 507.997, 508.181, 509.054, 509.283, 510.329, 513.589, 516.544, 517.734, 518.469, 519.771, 520.878, 520.923, 524.317, 526.735, 527.866, 527.932, 529.652, 530.578, 534.189, 534.279, 535.839, 537.522, 539.874, 543.946, 545.453, 546.145, 546.724, 550.36, 551.036, 558.588, 559.67, 563.361, 565.992, 566.847, 567.633, 568.282, 568.859, 568.926, 571.518, 572.602, 573.453, 574.981, 577.043, 579.026, 580.071, 581.687, 581.719, 585.912, 586.025, 587.957, 589.975, 595.153, 597.662, 597.848, 599.006, 602.808, 605.032, 606.728, 608.184, 609.405, 611.097, 611.955, 612.74, 615.849, 616.956, 625.134, 627.459, 628.167, 628.492, 628.68, 629.328, 630.461, 630.655, 641.422, 644.069, 648.874, 651.843, 652.438, 654.447, 655.978, 657.809, 662.22, 662.313, 663.917, 668.343, 668.523, 669.201, 671.914, 672.264, 676.73, 678.78, 679.491, 680.222, 680.324, 682.76, 683.96, 684.202, 684.775, 690.139, 691.408, 691.451, 691.975, 693.142, 693.648, 693.958, 697.04, 704.762, 706.171, 711.619, 715.455, 716.513, 718.875, 720.277, 722.03, 724.251, 724.752, 729.262, 729.382, 729.531, 729.962, 733.194, 733.559, 738.151, 738.938, 741.623, 743.038, 745.396, 745.513, 749.216, 749.834, 758.899, 758.913, 759.799, 762.209, 763.445, 767.891, 770.828, 771.861, 772.298, 774.906, 778.047, 778.945, 779.116, 781.562, 783.426, 788.749, 789.749, 791.139, 793.915, 794.334, 798.256, 801.092, 801.228, 802.655, 802.788, 806.318, 807.491, 808.765, 811.316, 811.884, 814.49, 815.555, 816.354, 820.732, 821.413, 821.759, 821.915, 823.246, 823.317, 824.927, 830.522, 832.113, 833.933, 833.985, 836.3, 836.887, 838.115, 839.745, 840.42, 842.239, 842.769, 844.461, 846.803, 850.951, 854.927, 855.536, 857.302, 858.555, 859.951, 862.581, 867.343, 867.911, 869.843, 875.41, 876.96, 877.874, 878.69, 881.782, 883.448, 886.502, 887.693, 889.463, 891.268, 895.848, 896.608, 897.154, 897.528, 899.355, 902.626, 902.932, 904.616, 904.783, 904.94, 908.49, 909.191, 909.524, 914.341, 915.174, 915.194, 915.269, 916.463, 918.283, 921.058, 927.638, 929.929, 930.608, 932.566, 932.667, 935.164, 937.439, 938.222, 938.887, 942.007, 942.074, 942.372, 944.71, 945.007, 945.974, 946.071, 946.9, 947.528, 949.077, 952.024, 952.178, 952.373, 953.2, 953.327, 956.901, 961.443, 963.826, 965.393, 967.986, 968.27, 970.394, 973.588, 975.704, 985.069, 985.131, 987.415, 990.302};

    auto res = app.bitonic_sort(sequence);
    EXPECT_EQ(1, std::get<0>(res) == correct);
}

TEST_F(bitonic_sort, accuracy_e20) {
    std::vector<float> sequence {2.0e-20, 5.0e-20, 6.0e-20, 1.0e-20, 4.0e-20, 3.0e-20};
    std::vector<float> correct  {1.0e-20, 2.0e-20, 3.0e-20, 4.0e-20, 5.0e-20, 6.0e-20};

    auto res = app.bitonic_sort(sequence);
    EXPECT_EQ(1, std::get<0>(res) == correct);
}

} //GTests